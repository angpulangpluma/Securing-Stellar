<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_51) on Sat Feb 06 16:35:55 MST 2016 -->
<meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
<title>AccessReferenceMap (ESAPI 2.1.0.1 API)</title>
<meta name="date" content="2016-02-06">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="AccessReferenceMap (ESAPI 2.1.0.1 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AccessReferenceMap.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../org/owasp/esapi/AccessControlRule.html" title="interface in org.owasp.esapi"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../org/owasp/esapi/Authenticator.html" title="interface in org.owasp.esapi"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/owasp/esapi/AccessReferenceMap.html" target="_top">Frames</a></li>
<li><a href="AccessReferenceMap.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.owasp.esapi</div>
<h2 title="Interface AccessReferenceMap" class="title">Interface AccessReferenceMap&lt;K&gt;</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Superinterfaces:</dt>
<dd>java.io.Serializable</dd>
</dl>
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../org/owasp/esapi/reference/AbstractAccessReferenceMap.html" title="class in org.owasp.esapi.reference">AbstractAccessReferenceMap</a>, <a href="../../../org/owasp/esapi/reference/IntegerAccessReferenceMap.html" title="class in org.owasp.esapi.reference">IntegerAccessReferenceMap</a>, <a href="../../../org/owasp/esapi/reference/RandomAccessReferenceMap.html" title="class in org.owasp.esapi.reference">RandomAccessReferenceMap</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="strong">AccessReferenceMap&lt;K&gt;</span>
extends java.io.Serializable</pre>
<div class="block">The AccessReferenceMap interface is used to map from a set of internal
 direct object references to a set of indirect references that are safe to
 disclose publicly. This can be used to help protect database keys,
 filenames, and other types of direct object references. As a rule, developers
 should not expose their direct object references as it enables attackers to
 attempt to manipulate them.
 <P>
 Indirect references are handled as strings, to facilitate their use in HTML.
 Implementations can generate simple integers or more complicated random
 character strings as indirect references. Implementations should probably add
 a constructor that takes a list of direct references.
 <P>
 Note that in addition to defeating all forms of parameter tampering attacks,
 there is a side benefit of the AccessReferenceMap. Using random strings as indirect object
 references, as opposed to simple integers makes it impossible for an attacker to
 guess valid identifiers. So if per-user AccessReferenceMaps are used, then request
 forgery (CSRF) attacks will also be prevented.
 
 <pre>
 Set fileSet = new HashSet();
 fileSet.addAll(...); // add direct references (e.g. File objects)
 AccessReferenceMap map = new AccessReferenceMap( fileSet );
 // store the map somewhere safe - like the session!
 String indRef = map.getIndirectReference( file1 );
 String href = &quot;http://www.aspectsecurity.com/esapi?file=&quot; + indRef );
 ...
 // if the indirect reference doesn't exist, it's likely an attack
 // getDirectReference throws an AccessControlException
 // you should handle as appropriate
 String indref = request.getParameter( &quot;file&quot; );
 File file = (File)map.getDirectReference( indref );
 </pre>
 
 <P></div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>Jeff Williams (jeff.williams@aspectsecurity.com), Chris Schmidt (chrisisbeef@gmail.com)</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>&lt;T&gt;&nbsp;<a href="../../../org/owasp/esapi/AccessReferenceMap.html" title="type parameter in AccessReferenceMap">K</a></code></td>
<td class="colLast"><code><strong><a href="../../../org/owasp/esapi/AccessReferenceMap.html#addDirectReference(T)">addDirectReference</a></strong>(T&nbsp;direct)</code>
<div class="block">Adds a direct reference to the AccessReferenceMap, then generates and returns 
 an associated indirect reference.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>&lt;T&gt;&nbsp;T</code></td>
<td class="colLast"><code><strong><a href="../../../org/owasp/esapi/AccessReferenceMap.html#getDirectReference(K)">getDirectReference</a></strong>(<a href="../../../org/owasp/esapi/AccessReferenceMap.html" title="type parameter in AccessReferenceMap">K</a>&nbsp;indirectReference)</code>
<div class="block">Get the original direct object reference from an indirect reference.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>&lt;T&gt;&nbsp;<a href="../../../org/owasp/esapi/AccessReferenceMap.html" title="type parameter in AccessReferenceMap">K</a></code></td>
<td class="colLast"><code><strong><a href="../../../org/owasp/esapi/AccessReferenceMap.html#getIndirectReference(T)">getIndirectReference</a></strong>(T&nbsp;directReference)</code>
<div class="block">Get a safe indirect reference to use in place of a potentially sensitive
 direct object reference.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.util.Iterator</code></td>
<td class="colLast"><code><strong><a href="../../../org/owasp/esapi/AccessReferenceMap.html#iterator()">iterator</a></strong>()</code>
<div class="block">Get an iterator through the direct object references.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>&lt;T&gt;&nbsp;<a href="../../../org/owasp/esapi/AccessReferenceMap.html" title="type parameter in AccessReferenceMap">K</a></code></td>
<td class="colLast"><code><strong><a href="../../../org/owasp/esapi/AccessReferenceMap.html#removeDirectReference(T)">removeDirectReference</a></strong>(T&nbsp;direct)</code>
<div class="block">Removes a direct reference and its associated indirect reference from the AccessReferenceMap.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../org/owasp/esapi/AccessReferenceMap.html#update(java.util.Set)">update</a></strong>(java.util.Set&nbsp;directReferences)</code>
<div class="block">Updates the access reference map with a new set of direct references, maintaining
 any existing indirect references associated with items that are in the new list.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="iterator()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>iterator</h4>
<pre>java.util.Iterator&nbsp;iterator()</pre>
<div class="block">Get an iterator through the direct object references. No guarantee is made as 
 to the order of items returned.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the iterator</dd></dl>
</li>
</ul>
<a name="getIndirectReference(java.lang.Object)">
<!--   -->
</a><a name="getIndirectReference(T)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getIndirectReference</h4>
<pre>&lt;T&gt;&nbsp;<a href="../../../org/owasp/esapi/AccessReferenceMap.html" title="type parameter in AccessReferenceMap">K</a>&nbsp;getIndirectReference(T&nbsp;directReference)</pre>
<div class="block">Get a safe indirect reference to use in place of a potentially sensitive
 direct object reference. Developers should use this call when building
 URL's, form fields, hidden fields, etc... to help protect their private
 implementation information.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>directReference</code> - the direct reference</dd>
<dt><span class="strong">Returns:</span></dt><dd>the indirect reference</dd></dl>
</li>
</ul>
<a name="getDirectReference(java.lang.Object)">
<!--   -->
</a><a name="getDirectReference(K)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDirectReference</h4>
<pre>&lt;T&gt;&nbsp;T&nbsp;getDirectReference(<a href="../../../org/owasp/esapi/AccessReferenceMap.html" title="type parameter in AccessReferenceMap">K</a>&nbsp;indirectReference)
                     throws <a href="../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</a></pre>
<div class="block">Get the original direct object reference from an indirect reference.
 Developers should use this when they get an indirect reference from a
 request to translate it back into the real direct reference. If an
 invalid indirect reference is requested, then an AccessControlException is
 thrown.

 If a type is implied the requested object will be cast to that type, if the
 object is not of the requested type, a AccessControlException will be thrown to
 the caller.

 For example:
 <pre>
 UserProfile profile = arm.getDirectReference( indirectRef );
 </pre>

 Will throw a AccessControlException if the object stored in memory is not of type
 UserProfile.

 However,
 <pre>
 Object uncastObject = arm.getDirectReference( indirectRef );
 </pre>

 Will never throw a AccessControlException as long as the object exists. If you are
 unsure of the object type of that an indirect reference references you should get
 the uncast object and test for type in the calling code.
 <pre>
 Object uncastProfile = arm.getDirectReference( indirectRef );
 if ( uncastProfile instanceof UserProfile ) {
     UserProfile userProfile = (UserProfile) uncastProfile;
     // ...
 } else {
     EmployeeProfile employeeProfile = (EmployeeProfile) uncastProfile;
     // ...
 }
 </pre></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>indirectReference</code> - the indirect reference</dd>
<dt><span class="strong">Returns:</span></dt><dd>the direct reference</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</a></code> - if no direct reference exists for the specified indirect reference</dd>
<dd><code>java.lang.ClassCastException</code> - if the implied type is not the same as the referenced object type</dd></dl>
</li>
</ul>
<a name="addDirectReference(java.lang.Object)">
<!--   -->
</a><a name="addDirectReference(T)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addDirectReference</h4>
<pre>&lt;T&gt;&nbsp;<a href="../../../org/owasp/esapi/AccessReferenceMap.html" title="type parameter in AccessReferenceMap">K</a>&nbsp;addDirectReference(T&nbsp;direct)</pre>
<div class="block">Adds a direct reference to the AccessReferenceMap, then generates and returns 
 an associated indirect reference.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>direct</code> - the direct reference</dd>
<dt><span class="strong">Returns:</span></dt><dd>the corresponding indirect reference</dd></dl>
</li>
</ul>
<a name="removeDirectReference(java.lang.Object)">
<!--   -->
</a><a name="removeDirectReference(T)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeDirectReference</h4>
<pre>&lt;T&gt;&nbsp;<a href="../../../org/owasp/esapi/AccessReferenceMap.html" title="type parameter in AccessReferenceMap">K</a>&nbsp;removeDirectReference(T&nbsp;direct)
                        throws <a href="../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</a></pre>
<div class="block">Removes a direct reference and its associated indirect reference from the AccessReferenceMap.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>direct</code> - the direct reference to remove</dd>
<dt><span class="strong">Returns:</span></dt><dd>the corresponding indirect reference</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</a></code> - if the reference does not exist.</dd></dl>
</li>
</ul>
<a name="update(java.util.Set)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>update</h4>
<pre>void&nbsp;update(java.util.Set&nbsp;directReferences)</pre>
<div class="block">Updates the access reference map with a new set of direct references, maintaining
 any existing indirect references associated with items that are in the new list.
 New indirect references could be generated every time, but that
 might mess up anything that previously used an indirect reference, such
 as a URL parameter.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>directReferences</code> - a Set of direct references to add</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AccessReferenceMap.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../org/owasp/esapi/AccessControlRule.html" title="interface in org.owasp.esapi"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../org/owasp/esapi/Authenticator.html" title="interface in org.owasp.esapi"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/owasp/esapi/AccessReferenceMap.html" target="_top">Frames</a></li>
<li><a href="AccessReferenceMap.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2016 <a href="http://www.owasp.org/index.php">The Open Web Application Security Project (OWASP)</a>. All rights reserved.</small></p>
</body>
</html>
