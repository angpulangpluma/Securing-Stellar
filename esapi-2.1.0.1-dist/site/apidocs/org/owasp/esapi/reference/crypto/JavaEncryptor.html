<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_51) on Sat Feb 06 16:35:57 MST 2016 -->
<meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
<title>JavaEncryptor (ESAPI 2.1.0.1 API)</title>
<meta name="date" content="2016-02-06">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="JavaEncryptor (ESAPI 2.1.0.1 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/JavaEncryptor.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/owasp/esapi/reference/crypto/EncryptedPropertiesUtils.html" title="class in org.owasp.esapi.reference.crypto"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../org/owasp/esapi/reference/crypto/ReferenceEncryptedProperties.html" title="class in org.owasp.esapi.reference.crypto"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/owasp/esapi/reference/crypto/JavaEncryptor.html" target="_top">Frames</a></li>
<li><a href="JavaEncryptor.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.owasp.esapi.reference.crypto</div>
<h2 title="Class JavaEncryptor" class="title">Class JavaEncryptor</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.owasp.esapi.reference.crypto.JavaEncryptor</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></dd>
</dl>
<hr>
<br>
<pre>public final class <span class="strong">JavaEncryptor</span>
extends java.lang.Object
implements <a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></pre>
<div class="block">Reference implementation of the <code>Encryptor</code> interface. This implementation
 layers on the JCE provided cryptographic package. Algorithms used are
 configurable in the <code>ESAPI.properties</code> file. The main property
 controlling the selection of this class is <code>ESAPI.Encryptor</code>. Most of
 the other encryption related properties have property names that start with
 the string "Encryptor.".</div>
<dl><dt><span class="strong">Since:</span></dt>
  <dd>June 1, 2007; some methods since ESAPI Java 2.0</dd>
<dt><span class="strong">Author:</span></dt>
  <dd>Jeff Williams (jeff.williams .at. aspectsecurity.com) <a
         href="http://www.aspectsecurity.com">Aspect Security</a>, kevin.w.wall@gmail.com, Chris Schmidt (chrisisbeef .at. gmail.com)</dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi"><code>Encryptor</code></a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#decrypt(org.owasp.esapi.crypto.CipherText)">decrypt</a></strong>(<a href="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</a>&nbsp;ciphertext)</code>
<div class="block">Decrypts the provided <a href="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto"><code>CipherText</code></a> using the information from it
 and the <i>master encryption key</i> as specified by the property
 <code>Encryptor.MasterKey</code> as defined in the <code>ESAPI.properties</code>
 file.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#decrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.CipherText)">decrypt</a></strong>(javax.crypto.SecretKey&nbsp;key,
       <a href="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</a>&nbsp;ciphertext)</code>
<div class="block">Decrypts the provided <a href="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto"><code>CipherText</code></a> using the information from it
 and the <i>specified secret key</i>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#encrypt(org.owasp.esapi.crypto.PlainText)">encrypt</a></strong>(<a href="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</a>&nbsp;plaintext)</code>
<div class="block">Encrypts the provided plaintext bytes using the cipher transformation
 specified by the property <code>Encryptor.CipherTransformation</code>
 and the <i>master encryption key</i> as specified by the property
 <code>Encryptor.MasterKey</code> as defined in the <code>ESAPI.properties</code> file.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#encrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.PlainText)">encrypt</a></strong>(javax.crypto.SecretKey&nbsp;key,
       <a href="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</a>&nbsp;plain)</code>
<div class="block">Encrypts the provided plaintext bytes using the cipher transformation
 specified by the property <code>Encryptor.CipherTransformation</code>
 as defined in the <code>ESAPI.properties</code> file and the
 <i>specified secret key</i>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#getInstance()">getInstance</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#getRelativeTimeStamp(long)">getRelativeTimeStamp</a></strong>(long&nbsp;offset)</code>
<div class="block">Gets an absolute timestamp representing an offset from the current time to be used by
 other functions in the library.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#getTimeStamp()">getTimeStamp</a></strong>()</code>
<div class="block">Gets a timestamp representing the current date and time to be used by
 other functions in the library.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#hash(java.lang.String, java.lang.String)">hash</a></strong>(java.lang.String&nbsp;plaintext,
    java.lang.String&nbsp;salt)</code>
<div class="block">Returns a string representation of the hash of the provided plaintext and
 salt.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#hash(java.lang.String, java.lang.String, int)">hash</a></strong>(java.lang.String&nbsp;plaintext,
    java.lang.String&nbsp;salt,
    int&nbsp;iterations)</code>
<div class="block">Returns a string representation of the hash of the provided plaintext and
 salt.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#main(java.lang.String[])">main</a></strong>(java.lang.String[]&nbsp;args)</code>
<div class="block">Generates a new strongly random secret key and salt that can be
 copy and pasted in the <b>ESAPI.properties</b> file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#seal(java.lang.String, long)">seal</a></strong>(java.lang.String&nbsp;data,
    long&nbsp;expiration)</code>
<div class="block">Creates a seal that binds a set of data and includes an expiration timestamp.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#sign(java.lang.String)">sign</a></strong>(java.lang.String&nbsp;data)</code>
<div class="block">Create a digital signature for the provided data and return it in a
 string.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#unseal(java.lang.String)">unseal</a></strong>(java.lang.String&nbsp;seal)</code>
<div class="block">Unseals data (created with the seal method) and throws an exception
 describing any of the various problems that could exist with a seal, such
 as an invalid seal format, expired timestamp, or decryption error.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#verifySeal(java.lang.String)">verifySeal</a></strong>(java.lang.String&nbsp;seal)</code>
<div class="block">Verifies a seal (created with the seal method) and throws an exception
 describing any of the various problems that could exist with a seal, such
 as an invalid seal format, expired timestamp, or data mismatch.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#verifySignature(java.lang.String, java.lang.String)">verifySignature</a></strong>(java.lang.String&nbsp;signature,
               java.lang.String&nbsp;data)</code>
<div class="block">Verifies a digital signature (created with the sign method) and returns
 the boolean result.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getInstance()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getInstance</h4>
<pre>public static&nbsp;<a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a>&nbsp;getInstance()
                             throws <a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></code></dd></dl>
</li>
</ul>
<a name="main(java.lang.String[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>main</h4>
<pre>public static&nbsp;void&nbsp;main(java.lang.String[]&nbsp;args)
                 throws java.lang.Exception</pre>
<div class="block">Generates a new strongly random secret key and salt that can be
 copy and pasted in the <b>ESAPI.properties</b> file.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>args</code> - Set first argument to "-print" to display available algorithms on standard output.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - To cover a multitude of sins, mostly in configuring ESAPI.properties.</dd></dl>
</li>
</ul>
<a name="hash(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hash</h4>
<pre>public&nbsp;java.lang.String&nbsp;hash(java.lang.String&nbsp;plaintext,
                    java.lang.String&nbsp;salt)
                      throws <a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></pre>
<div class="block">Returns a string representation of the hash of the provided plaintext and
 salt. The salt helps to protect against a rainbow table attack by mixing
 in some extra data with the plaintext. Some good choices for a salt might
 be an account name or some other string that is known to the application
 but not to an attacker.
 See <a href="http://www.matasano.com/log/958/enough-with-the-rainbow-tables-what-you-need-to-know-about-secure-password-schemes/">
 this article</a> for more information about hashing as it pertains to password schemes.
 
 Hashes the data with the supplied salt and the number of iterations specified in
 the ESAPI SecurityConfiguration.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/owasp/esapi/Encryptor.html#hash(java.lang.String, java.lang.String)">hash</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>plaintext</code> - the plaintext String to encrypt</dd><dd><code>salt</code> - the salt to add to the plaintext String before hashing</dd>
<dt><span class="strong">Returns:</span></dt><dd>the encrypted hash of 'plaintext' stored as a String</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></code> - if the specified hash algorithm could not be found or another problem exists with 
      the hashing of 'plaintext'</dd></dl>
</li>
</ul>
<a name="hash(java.lang.String, java.lang.String, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hash</h4>
<pre>public&nbsp;java.lang.String&nbsp;hash(java.lang.String&nbsp;plaintext,
                    java.lang.String&nbsp;salt,
                    int&nbsp;iterations)
                      throws <a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></pre>
<div class="block">Returns a string representation of the hash of the provided plaintext and
 salt. The salt helps to protect against a rainbow table attack by mixing
 in some extra data with the plaintext. Some good choices for a salt might
 be an account name or some other string that is known to the application
 but not to an attacker. 
 See <a href="http://www.matasano.com/log/958/enough-with-the-rainbow-tables-what-you-need-to-know-about-secure-password-schemes/">
 this article</a> for more information about hashing as it pertains to password schemes.
 
 Hashes the data using the specified algorithm and the Java MessageDigest class. This method
 first adds the salt, a separator (":"), and the data, and then rehashes the specified number of iterations
 in order to help strengthen weak passwords.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/owasp/esapi/Encryptor.html#hash(java.lang.String, java.lang.String, int)">hash</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>plaintext</code> - the plaintext String to encrypt</dd><dd><code>salt</code> - the salt to add to the plaintext String before hashing</dd><dd><code>iterations</code> - the number of times to iterate the hash</dd>
<dt><span class="strong">Returns:</span></dt><dd>the encrypted hash of 'plaintext' stored as a String</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></code> - if the specified hash algorithm could not be found or another problem exists with 
      the hashing of 'plaintext'</dd></dl>
</li>
</ul>
<a name="encrypt(org.owasp.esapi.crypto.PlainText)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encrypt</h4>
<pre>public&nbsp;<a href="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</a>&nbsp;encrypt(<a href="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</a>&nbsp;plaintext)
                   throws <a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></pre>
<div class="block">Encrypts the provided plaintext bytes using the cipher transformation
 specified by the property <code>Encryptor.CipherTransformation</code>
 and the <i>master encryption key</i> as specified by the property
 <code>Encryptor.MasterKey</code> as defined in the <code>ESAPI.properties</code> file.
 </p></div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/owasp/esapi/Encryptor.html#encrypt(org.owasp.esapi.crypto.PlainText)">encrypt</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>plaintext</code> - The <code>PlainText</code> to be encrypted.</dd>
<dt><span class="strong">Returns:</span></dt><dd>the <code>CipherText</code> object from which the raw ciphertext, the
                                IV, the cipher transformation, and many other aspects about
                                the encryption detail may be extracted.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></code> - Thrown if something should go wrong such as
                                the JCE provider cannot be found, the cipher algorithm,
                                cipher mode, or padding scheme not being supported, specifying
                                an unsupported key size, specifying an IV of incorrect length,
                                etc.</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../org/owasp/esapi/Encryptor.html#encrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.PlainText)"><code>Encryptor.encrypt(SecretKey, PlainText)</code></a></dd></dl>
</li>
</ul>
<a name="encrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.PlainText)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encrypt</h4>
<pre>public&nbsp;<a href="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</a>&nbsp;encrypt(javax.crypto.SecretKey&nbsp;key,
                 <a href="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</a>&nbsp;plain)
                   throws <a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></pre>
<div class="block">Encrypts the provided plaintext bytes using the cipher transformation
 specified by the property <code>Encryptor.CipherTransformation</code>
 as defined in the <code>ESAPI.properties</code> file and the
 <i>specified secret key</i>.
 </p><p>
 This method is similar to <a href="../../../../../org/owasp/esapi/Encryptor.html#encrypt(org.owasp.esapi.crypto.PlainText)"><code>Encryptor.encrypt(PlainText)</code></a> except that it
 permits a specific <code>SecretKey</code> to be used for encryption.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/owasp/esapi/Encryptor.html#encrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.PlainText)">encrypt</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>key</code> - The <code>SecretKey</code> to use for encrypting the plaintext.</dd><dd><code>plain</code> - The byte stream to be encrypted. Note if a Java
                                <code>String</code> is to be encrypted, it should be converted
                                using <code>"some string".getBytes("UTF-8")</code>.</dd>
<dt><span class="strong">Returns:</span></dt><dd>the <code>CipherText</code> object from which the raw ciphertext, the
                                IV, the cipher transformation, and many other aspects about
                                the encryption detail may be extracted.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></code> - Thrown if something should go wrong such as
                                the JCE provider cannot be found, the cipher algorithm,
                                cipher mode, or padding scheme not being supported, specifying
                                an unsupported key size, specifying an IV of incorrect length,
                                etc.</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../org/owasp/esapi/Encryptor.html#encrypt(org.owasp.esapi.crypto.PlainText)"><code>Encryptor.encrypt(PlainText)</code></a></dd></dl>
</li>
</ul>
<a name="decrypt(org.owasp.esapi.crypto.CipherText)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decrypt</h4>
<pre>public&nbsp;<a href="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</a>&nbsp;decrypt(<a href="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</a>&nbsp;ciphertext)
                  throws <a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></pre>
<div class="block">Decrypts the provided <a href="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto"><code>CipherText</code></a> using the information from it
 and the <i>master encryption key</i> as specified by the property
 <code>Encryptor.MasterKey</code> as defined in the <code>ESAPI.properties</code>
 file.
 </p></div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/owasp/esapi/Encryptor.html#decrypt(org.owasp.esapi.crypto.CipherText)">decrypt</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>ciphertext</code> - The <code>CipherText</code> object to be decrypted.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The <code>PlainText</code> object resulting from decrypting the specified
                   ciphertext. Note that it it is desired to convert the returned
                   plaintext byte array to a Java String is should be done using
                   <code>new String(byte[], "UTF-8");</code> rather than simply using
                   <code>new String(byte[]);</code> which uses native encoding and may
                   not be portable across hardware and/or OS platforms.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></code> - Thrown if something should go wrong such as
                                the JCE provider cannot be found, the cipher algorithm,
                                cipher mode, or padding scheme not being supported, specifying
                                an unsupported key size, or incorrect encryption key was
                                specified or a <code>PaddingException</code> occurs.</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../org/owasp/esapi/Encryptor.html#decrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.CipherText)"><code>Encryptor.decrypt(SecretKey, CipherText)</code></a></dd></dl>
</li>
</ul>
<a name="decrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.CipherText)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decrypt</h4>
<pre>public&nbsp;<a href="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</a>&nbsp;decrypt(javax.crypto.SecretKey&nbsp;key,
                <a href="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</a>&nbsp;ciphertext)
                  throws <a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a>,
                         java.lang.IllegalArgumentException</pre>
<div class="block">Decrypts the provided <a href="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto"><code>CipherText</code></a> using the information from it
 and the <i>specified secret key</i>.
 </p><p>
 This decrypt method is similar to <a href="../../../../../org/owasp/esapi/Encryptor.html#decrypt(org.owasp.esapi.crypto.CipherText)"><code>Encryptor.decrypt(CipherText)</code></a> except that
 it allows decrypting with a secret key other than the <i>master secret key</i>.
 </p></div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/owasp/esapi/Encryptor.html#decrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.CipherText)">decrypt</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>key</code> - The <code>SecretKey</code> to use for encrypting the plaintext.</dd><dd><code>ciphertext</code> - The <code>CipherText</code> object to be decrypted.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The <code>PlainText</code> object resulting from decrypting the specified
                   ciphertext. Note that it it is desired to convert the returned
                   plaintext byte array to a Java String is should be done using
                   <code>new String(byte[], "UTF-8");</code> rather than simply using
                   <code>new String(byte[]);</code> which uses native encoding and may
                   not be portable across hardware and/or OS platforms.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></code> - Thrown if something should go wrong such as
                                the JCE provider cannot be found, the cipher algorithm,
                                cipher mode, or padding scheme not being supported, specifying
                                an unsupported key size, or incorrect encryption key was
                                specified or a <code>PaddingException</code> occurs.</dd>
<dd><code>java.lang.IllegalArgumentException</code></dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../org/owasp/esapi/Encryptor.html#decrypt(org.owasp.esapi.crypto.CipherText)"><code>Encryptor.decrypt(CipherText)</code></a></dd></dl>
</li>
</ul>
<a name="sign(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sign</h4>
<pre>public&nbsp;java.lang.String&nbsp;sign(java.lang.String&nbsp;data)
                      throws <a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></pre>
<div class="block">Create a digital signature for the provided data and return it in a
 string.
 <p>
 <b>Limitations:</b> A new public/private key pair used for ESAPI 2.0 digital
 signatures with this method and <a href="../../../../../org/owasp/esapi/Encryptor.html#verifySignature(java.lang.String, java.lang.String)"><code>Encryptor.verifySignature(String, String)</code></a>
 are dynamically created when the default reference implementation class,
 <a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html" title="class in org.owasp.esapi.reference.crypto"><code>JavaEncryptor</code></a> is first created.
 Because this key pair is not persisted nor is the public key shared,
 this method and the corresponding <a href="../../../../../org/owasp/esapi/Encryptor.html#verifySignature(java.lang.String, java.lang.String)"><code>Encryptor.verifySignature(String, String)</code></a>
 can not be used with expected results across JVM instances. This limitation
 will be addressed in ESAPI 2.1.
 </p></div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/owasp/esapi/Encryptor.html#sign(java.lang.String)">sign</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>data</code> - the data to sign</dd>
<dt><span class="strong">Returns:</span></dt><dd>the digital signature stored as a String</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></code> - if the specified signature algorithm cannot be found</dd></dl>
</li>
</ul>
<a name="verifySignature(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifySignature</h4>
<pre>public&nbsp;boolean&nbsp;verifySignature(java.lang.String&nbsp;signature,
                      java.lang.String&nbsp;data)</pre>
<div class="block">Verifies a digital signature (created with the sign method) and returns
 the boolean result.
 <p>
 <b>Limitations:</b> A new public/private key pair used for ESAPI 2.0 digital
 signatures with this method and <a href="../../../../../org/owasp/esapi/Encryptor.html#sign(java.lang.String)"><code>Encryptor.sign(String)</code></a>
 are dynamically created when the default reference implementation class,
 <a href="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html" title="class in org.owasp.esapi.reference.crypto"><code>JavaEncryptor</code></a> is first created.
 Because this key pair is not persisted nor is the public key shared,
 this method and the corresponding <a href="../../../../../org/owasp/esapi/Encryptor.html#sign(java.lang.String)"><code>Encryptor.sign(String)</code></a>
 can not be used with expected results across JVM instances. This limitation
 will be addressed in ESAPI 2.1.
 </p></div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/owasp/esapi/Encryptor.html#verifySignature(java.lang.String, java.lang.String)">verifySignature</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>signature</code> - the signature to verify against 'data'</dd><dd><code>data</code> - the data to verify against 'signature'</dd>
<dt><span class="strong">Returns:</span></dt><dd>true, if the signature is verified, false otherwise</dd></dl>
</li>
</ul>
<a name="seal(java.lang.String, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>seal</h4>
<pre>public&nbsp;java.lang.String&nbsp;seal(java.lang.String&nbsp;data,
                    long&nbsp;expiration)
                      throws <a href="../../../../../org/owasp/esapi/errors/IntegrityException.html" title="class in org.owasp.esapi.errors">IntegrityException</a></pre>
<div class="block">Creates a seal that binds a set of data and includes an expiration timestamp.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/owasp/esapi/Encryptor.html#seal(java.lang.String, long)">seal</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>expiration</code> - </dd><dd><code>data</code> - the data to seal</dd>
<dt><span class="strong">Returns:</span></dt><dd>the seal</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/owasp/esapi/errors/IntegrityException.html" title="class in org.owasp.esapi.errors">IntegrityException</a></code></dd></dl>
</li>
</ul>
<a name="unseal(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unseal</h4>
<pre>public&nbsp;java.lang.String&nbsp;unseal(java.lang.String&nbsp;seal)
                        throws <a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></pre>
<div class="block">Unseals data (created with the seal method) and throws an exception
 describing any of the various problems that could exist with a seal, such
 as an invalid seal format, expired timestamp, or decryption error.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/owasp/esapi/Encryptor.html#unseal(java.lang.String)">unseal</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>seal</code> - the sealed data</dd>
<dt><span class="strong">Returns:</span></dt><dd>the original (unsealed) data</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></code> - if the unsealed data cannot be retrieved for any reason</dd></dl>
</li>
</ul>
<a name="verifySeal(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifySeal</h4>
<pre>public&nbsp;boolean&nbsp;verifySeal(java.lang.String&nbsp;seal)</pre>
<div class="block">Verifies a seal (created with the seal method) and throws an exception
 describing any of the various problems that could exist with a seal, such
 as an invalid seal format, expired timestamp, or data mismatch.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/owasp/esapi/Encryptor.html#verifySeal(java.lang.String)">verifySeal</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>seal</code> - the seal to verify</dd>
<dt><span class="strong">Returns:</span></dt><dd>true, if the seal is valid.  False otherwise</dd></dl>
</li>
</ul>
<a name="getTimeStamp()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTimeStamp</h4>
<pre>public&nbsp;long&nbsp;getTimeStamp()</pre>
<div class="block">Gets a timestamp representing the current date and time to be used by
 other functions in the library.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/owasp/esapi/Encryptor.html#getTimeStamp()">getTimeStamp</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>a timestamp representing the current time</dd></dl>
</li>
</ul>
<a name="getRelativeTimeStamp(long)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getRelativeTimeStamp</h4>
<pre>public&nbsp;long&nbsp;getRelativeTimeStamp(long&nbsp;offset)</pre>
<div class="block">Gets an absolute timestamp representing an offset from the current time to be used by
 other functions in the library.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/owasp/esapi/Encryptor.html#getRelativeTimeStamp(long)">getRelativeTimeStamp</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>offset</code> - the offset to add to the current time</dd>
<dt><span class="strong">Returns:</span></dt><dd>the absolute timestamp</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/JavaEncryptor.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/owasp/esapi/reference/crypto/EncryptedPropertiesUtils.html" title="class in org.owasp.esapi.reference.crypto"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../org/owasp/esapi/reference/crypto/ReferenceEncryptedProperties.html" title="class in org.owasp.esapi.reference.crypto"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/owasp/esapi/reference/crypto/JavaEncryptor.html" target="_top">Frames</a></li>
<li><a href="JavaEncryptor.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2016 <a href="http://www.owasp.org/index.php">The Open Web Application Security Project (OWASP)</a>. All rights reserved.</small></p>
</body>
</html>
