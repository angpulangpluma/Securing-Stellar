<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_51) on Sat Feb 06 16:35:56 MST 2016 -->
<meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
<title>CryptoToken (ESAPI 2.1.0.1 API)</title>
<meta name="date" content="2016-02-06">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="CryptoToken (ESAPI 2.1.0.1 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CryptoToken.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/owasp/esapi/crypto/CryptoHelper.html" title="class in org.owasp.esapi.crypto"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/owasp/esapi/crypto/KeyDerivationFunction.html" title="class in org.owasp.esapi.crypto"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/owasp/esapi/crypto/CryptoToken.html" target="_top">Frames</a></li>
<li><a href="CryptoToken.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.owasp.esapi.crypto</div>
<h2 title="Class CryptoToken" class="title">Class CryptoToken</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.owasp.esapi.crypto.CryptoToken</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">CryptoToken</span>
extends java.lang.Object</pre>
<div class="block">Compute a cryptographically secure, encrypted token containing
 optional name/value pairs. The cryptographic token is computed
 like this:
 <pre>
     username;expiration_time;[&lt;attr1&gt;;&lt;attr2&gt;;...;&lt;attrN&gt;;]
 </pre>
 where
 <i>username</i> is a user account name. Defaults to &lt;anonymous&gt; if
 not set and it is always converted to lower case as per the rules of the
 default locale. (Note this lower case conversion is consistent with the
 default reference implementation of ESAPI's <code>User</code> interface.)
 <br>
 <i>expiration_time</i> is time (in milliseconds) after which the encrypted
 token is considered invalid (i.e., expired). The time is stored as
 milliseconds since midnight, January 1, 1970 UTC, and optional attributes
 <br>
 &nbsp;&nbsp;<i>&lt;attr1&gt;</i>;<i>&lt;attr2&gt;</i>;...<i>&lt;attrN&gt;</i>;
 <br>
 are optional semicolon (';') separated name/value pairs, where each
 name/value pair has the form:
 <pre>
         name=[value]        (value may be empty, but not null)
 </pre>
 The attribute value may contain any value. However, values containing
 either '=' or ';' will be quoted using '\'. Likewise, values containing '\'
 will also be quoted using '\'. Hence if original name/value pair were
             name=ab=xy\;
         this would be represented as
             name=ab\=xy\\\;
 To ensure things are "safe" (from a security perspective), attribute
 <i>names</i> must conform the the Java regular expression
 <pre>
          [A-Za-z0-9_\.-]+
 </pre>
 The attribute <i>value</i> on the other hand, may be any valid string. (That
 is, the value is not checked, so beware!)
 <p>
 This entire semicolon-separated string is then encrypted via one of the 
 <code>Encryptor.encrypt()</code> methods and then base64-encoded, serialized
 IV + ciphertext + MAC representation as determined by
 <code>CipherTextasPortableSerializedByteArray()</code> is used as the
 resulting cryptographic token.
 <p>
 The attributes are sorted by attribute name and the attribute names
 must be unique. There are some restrictions on the attribute names.
 (See the <a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#setAttribute(java.lang.String, java.lang.String)"><code>setAttribute(String, String)</code></a> method for details.)</div>
<dl><dt><span class="strong">Since:</span></dt>
  <dd>2.0</dd>
<dt><span class="strong">Author:</span></dt>
  <dd>kevin.w.wall@gmail.com</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#ANONYMOUS_USER">ANONYMOUS_USER</a></strong></code>
<div class="block">Represents an anonymous user.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#CryptoToken()">CryptoToken</a></strong>()</code>
<div class="block">Create a cryptographic token using default secret key from the
 <b>ESAPI.properties</b> property <b>Encryptor.MasterKey</b>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#CryptoToken(javax.crypto.SecretKey)">CryptoToken</a></strong>(javax.crypto.SecretKey&nbsp;skey)</code>
<div class="block">Create a cryptographic token using specified <code>SecretKey</code>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#CryptoToken(javax.crypto.SecretKey, java.lang.String)">CryptoToken</a></strong>(javax.crypto.SecretKey&nbsp;skey,
           java.lang.String&nbsp;token)</code>
<div class="block">Create cryptographic token using previously encrypted token that was
 encrypted with specified secret key.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#CryptoToken(java.lang.String)">CryptoToken</a></strong>(java.lang.String&nbsp;token)</code>
<div class="block">Create using previously encrypted token encrypted with default secret
 key from <b>ESAPI.properties</b>.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#addAttributes(java.util.Map)">addAttributes</a></strong>(java.util.Map&lt;java.lang.String,java.lang.String&gt;&nbsp;attrs)</code>
<div class="block">Add the specified collection of attributes to the current attributes.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#clearAttributes()">clearAttributes</a></strong>()</code>
<div class="block">Removes all the attributes (if any) associated with this token.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#getAttribute(java.lang.String)">getAttribute</a></strong>(java.lang.String&nbsp;name)</code>
<div class="block">Retrieve the attribute with the specified name.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.util.Map&lt;java.lang.String,java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#getAttributes()">getAttributes</a></strong>()</code>
<div class="block">Retrieve a <code>Map</code> that is a clone of all the attributes.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#getExpiration()">getExpiration</a></strong>()</code>
<div class="block">Return the expiration time in milliseconds since epoch time (midnight,
 January 1, 1970 UTC).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.util.Date</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#getExpirationDate()">getExpirationDate</a></strong>()</code>
<div class="block">Return the expiration time as a <code>Date</code>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#getToken()">getToken</a></strong>()</code>
<div class="block">Return the new encrypted token as a base64-encoded string, encrypted with
 the specified <code>SecretKey</code> with which this object was constructed.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#getToken(javax.crypto.SecretKey)">getToken</a></strong>(javax.crypto.SecretKey&nbsp;skey)</code>
<div class="block">Return the new encrypted token as a base64-encoded string, encrypted with
 the specified <code>SecretKey</code> which may be a different key than what the
 token was originally encrypted with.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#getUserAccountName()">getUserAccountName</a></strong>()</code>
<div class="block">Retrieve the user account name associated with this <code>CryptoToken</code>
 object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#isExpired()">isExpired</a></strong>()</code>
<div class="block">Check if token has expired yet.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#setAttribute(java.lang.String, java.lang.String)">setAttribute</a></strong>(java.lang.String&nbsp;name,
            java.lang.String&nbsp;value)</code>
<div class="block">Set a name/value pair as an attribute.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#setExpiration(java.util.Date)">setExpiration</a></strong>(java.util.Date&nbsp;expirationDate)</code>
<div class="block">Set expiration time for a specific date/time.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#setExpiration(int)">setExpiration</a></strong>(int&nbsp;intervalSecs)</code>
<div class="block">Set expiration time to expire in 'interval' seconds (NOT milliseconds).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#setUserAccountName(java.lang.String)">setUserAccountName</a></strong>(java.lang.String&nbsp;userAccountName)</code>
<div class="block">Set the user account name associated with this cryptographic token
 object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#updateToken(int)">updateToken</a></strong>(int&nbsp;additionalSecs)</code>
<div class="block">Update the (current) expiration time by adding the specified number of
 seconds to it and then re-encrypting with the current <code>SecretKey</code>
 that was used to construct this object.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="ANONYMOUS_USER">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ANONYMOUS_USER</h4>
<pre>public static final&nbsp;java.lang.String ANONYMOUS_USER</pre>
<div class="block">Represents an anonymous user.</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../constant-values.html#org.owasp.esapi.crypto.CryptoToken.ANONYMOUS_USER">Constant Field Values</a></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="CryptoToken()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CryptoToken</h4>
<pre>public&nbsp;CryptoToken()</pre>
<div class="block">Create a cryptographic token using default secret key from the
 <b>ESAPI.properties</b> property <b>Encryptor.MasterKey</b>.</div>
</li>
</ul>
<a name="CryptoToken(javax.crypto.SecretKey)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CryptoToken</h4>
<pre>public&nbsp;CryptoToken(javax.crypto.SecretKey&nbsp;skey)</pre>
<div class="block">Create a cryptographic token using specified <code>SecretKey</code>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>skey</code> - The specified <code>SecretKey</code> to use to encrypt the token.</dd></dl>
</li>
</ul>
<a name="CryptoToken(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CryptoToken</h4>
<pre>public&nbsp;CryptoToken(java.lang.String&nbsp;token)
            throws <a href="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></pre>
<div class="block">Create using previously encrypted token encrypted with default secret
 key from <b>ESAPI.properties</b>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>token</code> - A previously encrypted token returned by one of the
              <code>getToken()</code> or <code>updateToken()</code> methods. The
              token <i>must</i> have been previously encrypted using the
              using default secret key from the <b>ESAPI.properties</b>
              property <b>Encryptor.MasterKey</b>.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></code> - Thrown if they are any problems while decrypting
                              the token using the default secret key from
                              <b>ESAPI.properties</b> or if the decrypted
                              token is not properly formatted.</dd></dl>
</li>
</ul>
<a name="CryptoToken(javax.crypto.SecretKey, java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CryptoToken</h4>
<pre>public&nbsp;CryptoToken(javax.crypto.SecretKey&nbsp;skey,
           java.lang.String&nbsp;token)
            throws <a href="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></pre>
<div class="block">Create cryptographic token using previously encrypted token that was
 encrypted with specified secret key.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>token</code> - A previously encrypted token returned by one of the
              <code>getToken()</code> or <code>updateToken()</code> methods.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></code> - Thrown if they are any problems while decrypting
                              the token using the default secret key from
                              <b>ESAPI.properties</b> or if the decrypted
                              token is not properly formatted.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getUserAccountName()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getUserAccountName</h4>
<pre>public&nbsp;java.lang.String&nbsp;getUserAccountName()</pre>
<div class="block">Retrieve the user account name associated with this <code>CryptoToken</code>
 object.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The user account name. The string represented by
          <a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#ANONYMOUS_USER"><code>ANONYMOUS_USER</code></a> is returned if
          <a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#setUserAccountName(java.lang.String)"><code>setUserAccountName(String)</code></a> was never called.</dd></dl>
</li>
</ul>
<a name="setUserAccountName(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setUserAccountName</h4>
<pre>public&nbsp;void&nbsp;setUserAccountName(java.lang.String&nbsp;userAccountName)
                        throws <a href="../../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</a></pre>
<div class="block">Set the user account name associated with this cryptographic token
 object. The user account name is converted to lower case.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>userAccountName</code> - The user account name.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</a></code> - Thrown if user account name is not valid, i.e.,
                              if it doesn't conform to the regular expression
                              given by "[a-z][a-z0-9_.@-]*". (Note that the
                              parameter <code>userAccountName</code> is first converted
                              to lower case before checked against the regular
                              expression.)</dd></dl>
</li>
</ul>
<a name="isExpired()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isExpired</h4>
<pre>public&nbsp;boolean&nbsp;isExpired()</pre>
<div class="block">Check if token has expired yet.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>True if token has expired; false otherwise.</dd></dl>
</li>
</ul>
<a name="setExpiration(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setExpiration</h4>
<pre>public&nbsp;void&nbsp;setExpiration(int&nbsp;intervalSecs)
                   throws java.lang.IllegalArgumentException</pre>
<div class="block">Set expiration time to expire in 'interval' seconds (NOT milliseconds).</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>intervalSecs</code> - Number of seconds in the future from current date/time
                        to set expiration. Must be positive.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code></dd></dl>
</li>
</ul>
<a name="setExpiration(java.util.Date)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setExpiration</h4>
<pre>public&nbsp;void&nbsp;setExpiration(java.util.Date&nbsp;expirationDate)
                   throws java.lang.IllegalArgumentException</pre>
<div class="block">Set expiration time for a specific date/time.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>expirationDate</code> - The date/time at which the token will fail. Must
                          be after the current date/time.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - Thrown if the parameter is null.</dd></dl>
</li>
</ul>
<a name="getExpiration()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getExpiration</h4>
<pre>public&nbsp;long&nbsp;getExpiration()</pre>
<div class="block">Return the expiration time in milliseconds since epoch time (midnight,
 January 1, 1970 UTC).</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The current expiration time.</dd></dl>
</li>
</ul>
<a name="getExpirationDate()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getExpirationDate</h4>
<pre>public&nbsp;java.util.Date&nbsp;getExpirationDate()</pre>
<div class="block">Return the expiration time as a <code>Date</code>.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The <code>Date</code> object representing the expiration time.</dd></dl>
</li>
</ul>
<a name="setAttribute(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setAttribute</h4>
<pre>public&nbsp;void&nbsp;setAttribute(java.lang.String&nbsp;name,
                java.lang.String&nbsp;value)
                  throws <a href="../../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</a></pre>
<div class="block">Set a name/value pair as an attribute.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>name</code> - The attribute name</dd><dd><code>value</code> - The attribute value</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</a></code> - Thrown if the attribute name is not properly
                              formed. That is, the attribute name does not
                              match the regular expression "[A-Za-z0-9_.-]+".</dd></dl>
</li>
</ul>
<a name="addAttributes(java.util.Map)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addAttributes</h4>
<pre>public&nbsp;void&nbsp;addAttributes(java.util.Map&lt;java.lang.String,java.lang.String&gt;&nbsp;attrs)
                   throws <a href="../../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</a></pre>
<div class="block">Add the specified collection of attributes to the current attributes.
 If there are duplicate attributes specified, they will replace any
 existing ones.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>attrs</code> - Name/value pairs of attributes to add or replace the existing
              attributes. Map must be non-null, but may be empty.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</a></code> - Thrown if one of the keys in the specified
                             parameter <code>attrs</code> is not a valid name.
                             That is, all attribute names must match the regular
                             expression ""[A-Za-z0-9_.-]+".</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#setAttribute(java.lang.String, java.lang.String)"><code>setAttribute(String, String)</code></a></dd></dl>
</li>
</ul>
<a name="getAttribute(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAttribute</h4>
<pre>public&nbsp;java.lang.String&nbsp;getAttribute(java.lang.String&nbsp;name)</pre>
<div class="block">Retrieve the attribute with the specified name.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>name</code> - The attribute name.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The value associated with the attribute name. If attribute is not
          set, then <code>null</code> is returned.</dd></dl>
</li>
</ul>
<a name="getAttributes()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAttributes</h4>
<pre>public&nbsp;java.util.Map&lt;java.lang.String,java.lang.String&gt;&nbsp;getAttributes()</pre>
<div class="block">Retrieve a <code>Map</code> that is a clone of all the attributes. A <i>copy</i>
 is returned so that the attributes in <code>CrytpToken</code> are unaffected
 by alterations made the returned <code>Map</code>. (Otherwise, multi-threaded code
 could get trick.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>A <code>Map</code> of all the attributes.</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#getAttribute(java.lang.String)"><code>getAttribute(String)</code></a></dd></dl>
</li>
</ul>
<a name="clearAttributes()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>clearAttributes</h4>
<pre>public&nbsp;void&nbsp;clearAttributes()</pre>
<div class="block">Removes all the attributes (if any) associated with this token. Note
 that this does not clear / reset the user account name or expiration time.</div>
</li>
</ul>
<a name="getToken(javax.crypto.SecretKey)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getToken</h4>
<pre>public&nbsp;java.lang.String&nbsp;getToken(javax.crypto.SecretKey&nbsp;skey)
                          throws <a href="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></pre>
<div class="block">Return the new encrypted token as a base64-encoded string, encrypted with
 the specified <code>SecretKey</code> which may be a different key than what the
 token was originally encrypted with. E.g.,
 <pre>
   Alice:
      SecretKey aliceSecretKey = ...; // Shared with Bob
      CryptoToken cryptoToken = new CryptoToken(skey1);
      cryptoToken.setUserAccountName("kwwall");
      cryptoToken.setAttribute("role", "admin");
      cryptoToken.setAttribute("state", "Ohio");
      String token = cryptoToken.getToken(); // Encrypted with skey1
      // send token to Bob ...
  --------------------------------------------------------------------
  Bob:
      ...
      SecretKey aliceSecretKey = ...  // Shared with Alice
      SecretKey bobSecretKey = ...;   // Shared with Carol
      CryptoToken cryptoToken = new CryptoToken(aliceSecretKey, tokenFromAlice);
      
      // Re-encrypt for Carol using my (Bob's) key...
      String tokenForCarol = cryptoToken.getToken(bobSecretKey);
      // send tokenForCarol to Carol ...
      // use token ourselves
  --------------------------------------------------------------------
  Carol:
      ...
      SecretKey bobSecretKey = ...;   // Shared with Bob.
      CryptoToken cryptoToken = new CryptoToken(bobSecretKey, tokenFromBob);
      if ( ! cryptoToken.isExpired() ) {
          String userName = cryptoToken.getUserAccountName();
          String roleName = cryptoToken.getAttribute("role");
          if ( roleName != null && roleName.equalsIgnoreCase("admin") ) {
              // grant admin access...
              ...
          }
      }
      ...
 </pre></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>skey</code> - The specified key to (re)encrypt the token.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The newly encrypted token.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></code></dd></dl>
</li>
</ul>
<a name="updateToken(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateToken</h4>
<pre>public&nbsp;java.lang.String&nbsp;updateToken(int&nbsp;additionalSecs)
                             throws <a href="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a>,
                                    <a href="../../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</a></pre>
<div class="block">Update the (current) expiration time by adding the specified number of
 seconds to it and then re-encrypting with the current <code>SecretKey</code>
 that was used to construct this object.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>additionalSecs</code> - The additional number of seconds to add to the
                          current expiration time. This number must be
                          &gt;= 0 or otherwise an <code>IllegalArgumentException</code>
                          is thrown.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The re-encrypted token with the updated expiration time is returned.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - Thrown if parameter <code>additionalSecs</code>
                                      is less than 0.</dd>
<dd><code><a href="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></code> - Thrown if the encryption fails.</dd>
<dd><code><a href="../../../../org/owasp/esapi/errors/ValidationException.html" title="class in org.owasp.esapi.errors">ValidationException</a></code> - Thrown if the token will have already expired
                                      even after adding the specified number of
                                      additional seconds.</dd>
<dd><code>java.lang.ArithmeticException</code> - If additional seconds is large enough such
                                      that it would cause an arithmetic overflow
                                      with a long (the current expiration time)
                                      when added to the <code>additionalSecs</code>
                                      parameter.</dd></dl>
</li>
</ul>
<a name="getToken()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getToken</h4>
<pre>public&nbsp;java.lang.String&nbsp;getToken()
                          throws <a href="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></pre>
<div class="block">Return the new encrypted token as a base64-encoded string, encrypted with
 the specified <code>SecretKey</code> with which this object was constructed.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>The newly encrypted token.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</a></code></dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/owasp/esapi/crypto/CryptoToken.html#getToken(javax.crypto.SecretKey)"><code>getToken(SecretKey)</code></a></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CryptoToken.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/owasp/esapi/crypto/CryptoHelper.html" title="class in org.owasp.esapi.crypto"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/owasp/esapi/crypto/KeyDerivationFunction.html" title="class in org.owasp.esapi.crypto"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/owasp/esapi/crypto/CryptoToken.html" target="_top">Frames</a></li>
<li><a href="CryptoToken.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2016 <a href="http://www.owasp.org/index.php">The Open Web Application Security Project (OWASP)</a>. All rights reserved.</small></p>
</body>
</html>
