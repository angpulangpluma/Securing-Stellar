<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.4 at 2016-02-06 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>ESAPI - CPD Results</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20160206" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                ESAPI
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 2016-02-06</span>
                  &nbsp;| <span id="projectVersion">Version: 2.1.0.1</span>
                      </div>
            <div class="xright">                    <a href="./" title="ESAPI">ESAPI</a>
              
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                          <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                                                            <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                                                                                                                                                                                                                          <li class="expanded">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                    <ul>
                      <li class="none">
                          <a href="findbugs.html" title="FindBugs Report">FindBugs Report</a>
            </li>
                      <li class="none">
                          <a href="cobertura/index.html" title="Cobertura Test Coverage">Cobertura Test Coverage</a>
            </li>
                      <li class="none">
                          <a href="jdepend-report.html" title="JDepend">JDepend</a>
            </li>
                      <li class="none">
                          <a href="pmd.html" title="PMD">PMD</a>
            </li>
                      <li class="none">
            <strong>CPD</strong>
          </li>
                      <li class="none">
                          <a href="apidocs/index.html" title="JavaDocs">JavaDocs</a>
            </li>
                      <li class="none">
                          <a href="testapidocs/index.html" title="Test JavaDocs">Test JavaDocs</a>
            </li>
                      <li class="none">
                          <a href="dev-activity.html" title="Developer Activity">Developer Activity</a>
            </li>
                      <li class="none">
                          <a href="file-activity.html" title="File Activity">File Activity</a>
            </li>
                      <li class="none">
                          <a href="changelog.html" title="Change Log">Change Log</a>
            </li>
                      <li class="none">
                          <a href="dependency-updates-report.html" title="Dependency Updates Report">Dependency Updates Report</a>
            </li>
                      <li class="none">
                          <a href="plugin-updates-report.html" title="Plugin Updates Report">Plugin Updates Report</a>
            </li>
                      <li class="none">
                          <a href="property-updates-report.html" title="Property Updates Report">Property Updates Report</a>
            </li>
                      <li class="none">
                          <a href="dependency-check-report.html" title="dependency-check">dependency-check</a>
            </li>
                      <li class="none">
                          <a href="surefire-report.html" title="Surefire Report">Surefire Report</a>
            </li>
              </ul>
        </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section">
<h2>CPD Results<a name="CPD_Results"></a></h2>
<p>The following document contains the results of PMD's  <a class="externalLink" href="http://pmd.sourceforge.net/cpd.html">CPD</a> 5.0.5.</p></div>
<div class="section">
<h2>Duplications<a name="Duplications"></a></h2>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/owasp/esapi/reference/DefaultAccessController.java</td>
<td>67</td></tr>
<tr class="a">
<td>org/owasp/esapi/reference/accesscontrol/ExperimentalAccessController.java</td>
<td>54</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>		try {
			AccessControlRule rule = (AccessControlRule)ruleMap.get(key);
			if(rule == null) {
				throw new AccessControlException(&quot;Access Denied&quot;, 
						&quot;AccessControlRule was not found for key: &quot; + key); 
			}
			if(logger.isDebugEnabled()){ logger.debug(Logger.EVENT_SUCCESS, &quot;Asserting Authorization Rule \&quot;&quot; + key + &quot;\&quot; Using class: &quot; + rule.getClass().getCanonicalName()); }
			isAuthorized = rule.isAuthorized(runtimeParameter);
		} catch(Exception e) {
			//TODO figure out what which string goes where.		
			throw new AccessControlException(&quot;Access Denied&quot;, &quot;An unhandled Exception was &quot; +
					&quot;caught, so access is denied.&quot; +
					&quot;AccessControlException.&quot;,
					e);
		}
		if(!isAuthorized) {
			throw new AccessControlException(&quot;Access Denied&quot;, 
					&quot;Access Denied for key: &quot; + key + 
					&quot; runtimeParameter: &quot; + runtimeParameter);
		}
	}
	
    /** {@inheritDoc} */
	public void assertAuthorizedForData(String action, Object data)
			throws AccessControlException {
		this.assertAuthorized(&quot;AC 1.0 Data&quot;, new Object[] {action, data});
	}

	/**
     * {@inheritDoc}
	 * @deprecated
	 */
	public void assertAuthorizedForFile(String filepath)
			throws AccessControlException {
		this.assertAuthorized(&quot;AC 1.0 File&quot;, new Object[] {filepath});
	}

    /** {@inheritDoc} */
	public void assertAuthorizedForFunction(String functionName)
			throws AccessControlException {
		this.assertAuthorized(&quot;AC 1.0 Function&quot;, new Object[] {functionName});
	}

    /** {@inheritDoc} */
	public void assertAuthorizedForService(String serviceName)
			throws AccessControlException {
		this.assertAuthorized(&quot;AC 1.0 Service&quot;, new Object[] {serviceName});
	}

    /** {@inheritDoc} */
	public void assertAuthorizedForURL(String url)
			throws AccessControlException {
		this.assertAuthorized(&quot;AC 1.0 URL&quot;, new Object[] {url});
	}

    /** {@inheritDoc} */
	public boolean isAuthorizedForData(String action, Object data) {
		return this.isAuthorized(&quot;AC 1.0 Data&quot;, new Object[] {action, data});
	}

    /** {@inheritDoc} */
	public boolean isAuthorizedForFile(String filepath) {
		return this.isAuthorized(&quot;AC 1.0 File&quot;, new Object[] {filepath});
	}

    /** {@inheritDoc} */
	public boolean isAuthorizedForFunction(String functionName) {
		return this.isAuthorized(&quot;AC 1.0 Function&quot;, new Object[] {functionName});
	}

    /** {@inheritDoc} */
	public boolean isAuthorizedForService(String serviceName) {
		return this.isAuthorized(&quot;AC 1.0 Service&quot;, new Object[] {serviceName});
	}

    /** {@inheritDoc} */
	public boolean isAuthorizedForURL(String url) {
		return this.isAuthorized(&quot;AC 1.0 URL&quot;, new Object[] {url});
	}
}</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>181</td></tr>
<tr class="a">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>243</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>	private final static byte[] _STANDARD_ALPHABET =
    {
        (byte)'A', (byte)'B', (byte)'C', (byte)'D', (byte)'E', (byte)'F', (byte)'G',
        (byte)'H', (byte)'I', (byte)'J', (byte)'K', (byte)'L', (byte)'M', (byte)'N',
        (byte)'O', (byte)'P', (byte)'Q', (byte)'R', (byte)'S', (byte)'T', (byte)'U', 
        (byte)'V', (byte)'W', (byte)'X', (byte)'Y', (byte)'Z',
        (byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e', (byte)'f', (byte)'g',
        (byte)'h', (byte)'i', (byte)'j', (byte)'k', (byte)'l', (byte)'m', (byte)'n',
        (byte)'o', (byte)'p', (byte)'q', (byte)'r', (byte)'s', (byte)'t', (byte)'u', 
        (byte)'v', (byte)'w', (byte)'x', (byte)'y', (byte)'z',
        (byte)'0', (byte)'1', (byte)'2', (byte)'3', (byte)'4', (byte)'5', 
        (byte)'6', (byte)'7', (byte)'8', (byte)'9', (byte)'+', (byte)'/'</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/owasp/esapi/waf/rules/RuleUtil.java</td>
<td>52</td></tr>
<tr class="a">
<td>org/owasp/esapi/waf/rules/RuleUtil.java</td>
<td>97</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>			Object o = it.next();

			if ( o instanceof String ) {

				if ( s.equals((String)o)) {
					return true;
				}

			} else if ( o instanceof Integer ) {

				try {
					if ( Integer.parseInt(s) == ((Integer)o).intValue() ) {
						return true;
					}
				} catch (Exception e) {}

			} else if ( o instanceof Long ) {

				try {
					if ( Long.parseLong(s) == ((Long)o).longValue() ) {
						return true;
					}
				} catch (Exception e) {}

			} else if ( o instanceof Double ) {

				try {
					if ( Double.compare(Double.parseDouble(s), ((Double)o).doubleValue()) ==  0 ) {
						return true;
					}
				} catch (Exception e) {}
			}

		}

		return false;
	}

	/*
	 * Enumeration
	 */
	public static boolean isInList(Enumeration en, String s) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/owasp/esapi/waf/ESAPIWebApplicationFirewallFilter.java</td>
<td>338</td></tr>
<tr class="a">
<td>org/owasp/esapi/waf/ESAPIWebApplicationFirewallFilter.java</td>
<td>397</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>			logger.debug(Logger.EVENT_SUCCESS, &quot;  Applying BEFORE CHAIN rule:  &quot; + rule.getClass().getName());

			/*
			 * The rules execute in check(). The check() method will take care
			 * of logging. All we have to do is decide what other actions to
			 * take.
			 */
			Action action = rule.check(request, response, httpResponse);

			if (action.isActionNecessary()) {

				if (action instanceof BlockAction) {
					if (response != null) {
						response.setStatus(appGuardConfig.getDefaultResponseCode());
					} else {
						httpResponse.setStatus(appGuardConfig.getDefaultResponseCode());
					}
					return;

				} else if (action instanceof RedirectAction) {
					sendRedirect(response, httpResponse, ((RedirectAction) action).getRedirectURL());
					return;

				} else if (action instanceof DefaultAction) {

					switch (AppGuardianConfiguration.DEFAULT_FAIL_ACTION) {
					case AppGuardianConfiguration.BLOCK:
						if (response != null) {
							response.setStatus(appGuardConfig.getDefaultResponseCode());
						} else {
							httpResponse.setStatus(appGuardConfig.getDefaultResponseCode());
						}
						return;

					case AppGuardianConfiguration.REDIRECT:
						sendRedirect(response, httpResponse);
						return;
					}
				}
			}
		}</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/owasp/esapi/reference/DefaultAccessController.java</td>
<td>31</td></tr>
<tr class="a">
<td>org/owasp/esapi/reference/accesscontrol/ExperimentalAccessController.java</td>
<td>21</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>	private DefaultAccessController() throws AccessControlException {
		ACRPolicyFileLoader policyDescriptor = new ACRPolicyFileLoader();
		PolicyDTO policyDTO = policyDescriptor.load();		
		ruleMap = policyDTO.getAccessControlRules();
	}

    /**
     * {@inheritDoc}
     */
	public boolean isAuthorized(Object key, Object runtimeParameter) {
		try {
			AccessControlRule rule = (AccessControlRule)ruleMap.get(key);
			if(rule == null) {
				throw new AccessControlException(&quot;Access Denied&quot;,
						&quot;AccessControlRule was not found for key: &quot; + key); 
			}
			if(logger.isDebugEnabled()){ logger.debug(Logger.EVENT_SUCCESS, &quot;Evaluating Authorization Rule \&quot;&quot; + key + &quot;\&quot; Using class: &quot; + rule.getClass().getCanonicalName()); }
			return rule.isAuthorized(runtimeParameter);
		} catch(Exception e) {
			try {
				//Log the exception by throwing and then catching it.
				//TODO figure out what which string goes where.		
				throw new AccessControlException(&quot;Access Denied&quot;,
					&quot;An unhandled Exception was &quot; +
					&quot;caught, so access is denied.&quot;,  
					e);	
			} catch(AccessControlException ace) {
				//the exception was just logged. There's nothing left to do.
			}
			return false; //fail closed
		}
	}

    /** {@inheritDoc} */
	public void assertAuthorized(Object key, Object runtimeParameter) throws AccessControlException {
		boolean isAuthorized;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/owasp/esapi/waf/ESAPIWebApplicationFirewallFilter.java</td>
<td>282</td></tr>
<tr class="a">
<td>org/owasp/esapi/waf/ESAPIWebApplicationFirewallFilter.java</td>
<td>345</td></tr>
<tr class="b">
<td>org/owasp/esapi/waf/ESAPIWebApplicationFirewallFilter.java</td>
<td>403</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>			Action action = rule.check(httpRequest, response, httpResponse);

			if (action.isActionNecessary()) {

				if (action instanceof BlockAction) {
					if (response != null) {
						response.setStatus(appGuardConfig.getDefaultResponseCode());
					} else {
						httpResponse.setStatus(appGuardConfig.getDefaultResponseCode());
					}
					return;

				} else if (action instanceof RedirectAction) {
					sendRedirect(response, httpResponse, ((RedirectAction) action).getRedirectURL());
					return;

				} else if (action instanceof DefaultAction) {

					switch (AppGuardianConfiguration.DEFAULT_FAIL_ACTION) {
					case AppGuardianConfiguration.BLOCK:
						if (response != null) {
							response.setStatus(appGuardConfig.getDefaultResponseCode());
						} else {
							httpResponse.setStatus(appGuardConfig.getDefaultResponseCode());
						}
						return;

					case AppGuardianConfiguration.REDIRECT:
						sendRedirect(response, httpResponse);
						return;
					}
				}
			}
		}</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/owasp/esapi/reference/JavaLogFactory.java</td>
<td>365</td></tr>
<tr class="b">
<td>org/owasp/esapi/reference/Log4JLogger.java</td>
<td>497</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    	    return jlogger.isLoggable(Level.WARNING);
        }
        
        public String getUserInfo() {
            // create a random session number for the user to represent the user's 'session', if it doesn't exist already
            String sid = null;
            HttpServletRequest request = ESAPI.httpUtilities().getCurrentRequest();
            if ( request != null ) {
                HttpSession session = request.getSession( false );
                if ( session != null ) {
	                sid = (String)session.getAttribute(&quot;ESAPI_SESSION&quot;);
	                // if there is no session ID for the user yet, we create one and store it in the user's session
		            if ( sid == null ) {
		            	sid = &quot;&quot;+ ESAPI.randomizer().getRandomInteger(0, 1000000);
		            	session.setAttribute(&quot;ESAPI_SESSION&quot;, sid);
		            }
                }
            }
            
			// log user information - username:session@ipaddr
			User user = ESAPI.authenticator().getCurrentUser();            
			String userInfo = &quot;&quot;;
			//TODO - Make Type Logging configurable
			if ( user != null) {
				userInfo += user.getAccountName()+ &quot;:&quot; + sid + &quot;@&quot;+ user.getLastHostAddress();
			}
			
			return userInfo;
        }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>260</td></tr>
<tr class="b">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>326</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    private final static byte[] _URL_SAFE_DECODABET =
    {   
      -9,-9,-9,-9,-9,-9,-9,-9,-9,                 // Decimal  0 -  8
      -5,-5,                                      // Whitespace: Tab and Linefeed
      -9,-9,                                      // Decimal 11 - 12
      -5,                                         // Whitespace: Carriage Return
      -9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,     // Decimal 14 - 26
      -9,-9,-9,-9,-9,                             // Decimal 27 - 31
      -5,                                         // Whitespace: Space
      -9,-9,-9,-9,-9,-9,-9,-9,-9,-9,              // Decimal 33 - 42
      -9,                                         // Plus sign at decimal 43
      -9,                                         // Decimal 44</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>183</td></tr>
<tr class="b">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>245</td></tr>
<tr class="a">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>312</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        (byte)'A', (byte)'B', (byte)'C', (byte)'D', (byte)'E', (byte)'F', (byte)'G',
        (byte)'H', (byte)'I', (byte)'J', (byte)'K', (byte)'L', (byte)'M', (byte)'N',
        (byte)'O', (byte)'P', (byte)'Q', (byte)'R', (byte)'S', (byte)'T', (byte)'U', 
        (byte)'V', (byte)'W', (byte)'X', (byte)'Y', (byte)'Z',
        (byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e', (byte)'f', (byte)'g',</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>200</td></tr>
<tr class="a">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>260</td></tr>
<tr class="b">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>326</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    private final static byte[] _STANDARD_DECODABET =
    {   
        -9,-9,-9,-9,-9,-9,-9,-9,-9,                 // Decimal  0 -  8
        -5,-5,                                      // Whitespace: Tab and Linefeed
        -9,-9,                                      // Decimal 11 - 12
        -5,                                         // Whitespace: Carriage Return
        -9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,     // Decimal 14 - 26
        -9,-9,-9,-9,-9,                             // Decimal 27 - 31
        -5,                                         // Whitespace: Space
        -9,-9,-9,-9,-9,-9,-9,-9,-9,-9,              // Decimal 33 - 42</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>186</td></tr>
<tr class="b">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>248</td></tr>
<tr class="a">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>316</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        (byte)'V', (byte)'W', (byte)'X', (byte)'Y', (byte)'Z',
        (byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e', (byte)'f', (byte)'g',
        (byte)'h', (byte)'i', (byte)'j', (byte)'k', (byte)'l', (byte)'m', (byte)'n',
        (byte)'o', (byte)'p', (byte)'q', (byte)'r', (byte)'s', (byte)'t', (byte)'u', 
        (byte)'v', (byte)'w', (byte)'x', (byte)'y', (byte)'z',</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/owasp/esapi/codecs/DB2Codec.java</td>
<td>33</td></tr>
<tr class="a">
<td>org/owasp/esapi/codecs/OracleCodec.java</td>
<td>48</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>		return &quot;&quot; + c;
	}

	public Character decodeCharacter(PushbackString input) {

		input.mark();
		Character first = input.next();

		if (first == null) {
			input.reset();
			return null;
		}

		// if this is not an encoded character, return null

		if (first.charValue() != '\'') {
			input.reset();
			return null;
		}

		Character second = input.next();

		if (second == null) {
			input.reset();
			return null;
		}

		// if this is not an encoded character, return null
		if (second.charValue() != '\'') {
			input.reset();
			return null;
		}

		return (Character.valueOf('\''));
	}
}</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>212</td></tr>
<tr class="a">
<td>org/owasp/esapi/codecs/Base64.java</td>
<td>274</td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        63,                                         // Slash at decimal 47
        52,53,54,55,56,57,58,59,60,61,              // Numbers zero through nine
        -9,-9,-9,                                   // Decimal 58 - 60
        -1,                                         // Equals sign at decimal 61
        -9,-9,-9,                                      // Decimal 62 - 64
        0,1,2,3,4,5,6,7,8,9,10,11,12,13,            // Letters 'A' through 'N'
        14,15,16,17,18,19,20,21,22,23,24,25,        // Letters 'O' through 'Z'
        -9,-9,-9,-9,-9,-9,                          // Decimal 91 - 96</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>org/owasp/esapi/codecs/DB2Codec.java</td>
<td>36</td></tr>
<tr class="a">
<td>org/owasp/esapi/codecs/MySQLCodec.java</td>
<td>181</td></tr>
<tr class="b">
<td>org/owasp/esapi/codecs/OracleCodec.java</td>
<td>62</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>	public Character decodeCharacter(PushbackString input) {

		input.mark();
		Character first = input.next();

		if (first == null) {
			input.reset();
			return null;
		}

		// if this is not an encoded character, return null

		if (first.charValue() != '\'') {
			input.reset();
			return null;
		}

		Character second = input.next();

		if (second == null) {
			input.reset();
			return null;
		}

		// if this is not an encoded character, return null
		if (second.charValue() != '\'') {
			input.reset();
			return null;
		}

		return (Character.valueOf('\''));
	}</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/owasp/esapi/filters/SecurityWrapperResponse.java</td>
<td>119</td></tr>
<tr class="b">
<td>org/owasp/esapi/reference/DefaultHTTPUtilities.java</td>
<td>335</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        throw new IntrusionException(&quot;Security error&quot;, &quot;Attempt to add unsafe data to cookie (throw mode)&quot;);
    }

    private String createCookieHeader(String name, String value, int maxAge, String domain, String path, boolean secure) {
        // create the special cookie header instead of creating a Java cookie
        // Set-Cookie:&lt;name&gt;=&lt;value&gt;[; &lt;name&gt;=&lt;value&gt;][; expires=&lt;date&gt;][;
        // domain=&lt;domain_name&gt;][; path=&lt;some_path&gt;][; secure][;HttpOnly
        String header = name + &quot;=&quot; + value;
        header += &quot;; Max-Age=&quot; + maxAge;
        if (domain != null) {
            header += &quot;; Domain=&quot; + domain;
        }
        if (path != null) {
            header += &quot;; Path=&quot; + path;
        }
        if ( secure || ESAPI.securityConfiguration().getForceSecureCookies() ) {
			header += &quot;; Secure&quot;;
        }
        if ( ESAPI.securityConfiguration().getForceHttpOnlyCookies() ) {
			header += &quot;; HttpOnly&quot;;
        }
        return header;
    }

    /**
     * Add a cookie to the response after ensuring that there are no encoded or
     * illegal characters in the name.
     * @param name 
     * @param date
     */
    public void addDateHeader(String name, long date) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>org/owasp/esapi/reference/JavaLogFactory.java</td>
<td>293</td></tr>
<tr class="b">
<td>org/owasp/esapi/reference/Log4JLogger.java</td>
<td>420</td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            if ( message == null ) {
            	message = &quot;&quot;;
            }
            
            // ensure no CRLF injection into logs for forging records
            String clean = message.replace( '\n', '_' ).replace( '\r', '_' );
            if ( ESAPI.securityConfiguration().getLogEncodingRequired() ) {
            	clean = ESAPI.encoder().encodeForHTML(message);
                if (!message.equals(clean)) {
                    clean += &quot; (Encoded)&quot;;
                }
            }

			// log server, port, app name, module name -- server:80/app/module
			StringBuilder appInfo = new StringBuilder();
			if ( ESAPI.currentRequest() != null &amp;&amp; logServerIP ) {
				appInfo.append( ESAPI.currentRequest().getLocalAddr() + &quot;:&quot; + ESAPI.currentRequest().getLocalPort() );</pre></div></td></tr></table></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2016
                        <a href="http://www.owasp.org/index.php">The Open Web Application Security Project (OWASP)</a>.
            All Rights Reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
